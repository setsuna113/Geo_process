2025-07-22 22:40:06,044 - __main__ - INFO - üìù Logging to: logs/richness_analysis_20250722_224006.log
2025-07-22 22:40:06,044 - __main__ - INFO - üöÄ Starting ENHANCED richness dataset processing pipeline
2025-07-22 22:40:06,044 - __main__ - INFO - üîß Features: Progress tracking, Checkpoints, Memory monitoring, Error recovery
2025-07-22 22:40:06,050 - src.database.connection - INFO - ‚úÖ Database connection pool created (attempt 1)
2025-07-22 22:40:06,050 - src.database.connection - INFO -    Host: localhost:5432
2025-07-22 22:40:06,050 - src.database.connection - INFO -    Database: geoprocess_db
2025-07-22 22:40:06,050 - src.database.connection - INFO -    User: jason
2025-07-22 22:40:06,053 - src.database.connection - INFO - ‚úÖ PostgreSQL: PostgreSQL 14.18 (Ubuntu 14.18-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu
2025-07-22 22:40:06,053 - src.database.connection - INFO - ‚úÖ PostGIS: 3.2 USE_GEOS=1 USE_PROJ=1 USE_STATS=1
2025-07-22 22:40:06,053 - __main__ - INFO - Checking database setup...
2025-07-22 22:40:06,054 - src.database.connection - INFO - ‚úÖ PostgreSQL: PostgreSQL 14.18 (Ubuntu 14.18-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu
2025-07-22 22:40:06,054 - src.database.connection - INFO - ‚úÖ PostGIS: 3.2 USE_GEOS=1 USE_PROJ=1 USE_STATS=1
2025-07-22 22:40:06,054 - __main__ - INFO - üì• STAGE 1: Loading datasets into catalog...
2025-07-22 22:40:06,054 - __main__ - INFO - ‚úÖ Found datasets:
  - Plants: data/richness_maps/daru-plants-richness.tif
  - Terrestrial: data/richness_maps/iucn-terrestrial-richness.tif
2025-07-22 22:40:06,099 - src.raster.loaders.geotiff_loader - INFO - Loaded metadata for daru-plants-richness.tif:
2025-07-22 22:40:06,099 - src.raster.loaders.geotiff_loader - INFO -   Size: 21600 x 10410
2025-07-22 22:40:06,099 - src.raster.loaders.geotiff_loader - INFO -   Resolution: 0.016667¬∞
2025-07-22 22:40:06,099 - src.raster.loaders.geotiff_loader - INFO -   Data type: Int32
2025-07-22 22:40:06,099 - src.raster.loaders.geotiff_loader - INFO -   NoData: 0.0
2025-07-22 22:40:06,199 - __main__ - INFO - ‚úÖ Added plants dataset: daru-plants-richness
2025-07-22 22:40:06,221 - src.raster.loaders.geotiff_loader - INFO - Loaded metadata for iucn-terrestrial-richness.tif:
2025-07-22 22:40:06,221 - src.raster.loaders.geotiff_loader - INFO -   Size: 21600 x 8280
2025-07-22 22:40:06,221 - src.raster.loaders.geotiff_loader - INFO -   Resolution: 0.016667¬∞
2025-07-22 22:40:06,221 - src.raster.loaders.geotiff_loader - INFO -   Data type: UInt16
2025-07-22 22:40:06,221 - src.raster.loaders.geotiff_loader - INFO -   NoData: 0.0
2025-07-22 22:40:06,313 - __main__ - INFO - ‚úÖ Added terrestrial dataset: iucn-terrestrial-richness
2025-07-22 22:40:06,314 - __main__ - INFO - ‚úÖ Checkpoint saved: catalog_loaded
2025-07-22 22:40:06,315 - __main__ - INFO - üîó STAGE 2: Merging datasets with robust alignment...
2025-07-22 22:40:06,315 - src.base.memory_tracker - INFO - Memory monitoring started
2025-07-22 22:40:06,315 - __main__ - INFO - üìä Dataset size: 224,856,000 pixels
2025-07-22 22:40:06,315 - __main__ - INFO - ‚è±Ô∏è  Estimated merge time: ~3m
2025-07-22 22:40:06,315 - src.processors.data_preparation.raster_merger - INFO - Merging 2 rasters
2025-07-22 22:40:06,319 - src.processors.data_preparation.raster_alignment - INFO - Analyzing alignment with reference: daru-plants-richness.tif
2025-07-22 22:40:06,321 - src.processors.data_preparation.raster_merger - INFO - Found 1 alignment issues, attempting fixes...
2025-07-22 22:40:06,322 - src.processors.data_preparation.raster_alignment - INFO - Analyzing alignment with reference: daru-plants-richness.tif
2025-07-22 22:40:06,450 - src.processors.data_preparation.raster_alignment - INFO - Aligned daru-plants-richness.tif -> aligned_daru-plants-richness.tif
2025-07-22 22:40:08,994 - src.processors.data_preparation.raster_alignment - INFO - Aligned iucn-terrestrial-richness.tif -> aligned_iucn-terrestrial-richness.tif
2025-07-22 22:40:08,994 - src.processors.data_preparation.raster_alignment - INFO - Analyzing alignment with reference: aligned_daru-plants-richness.tif
2025-07-22 22:40:08,996 - src.processors.data_preparation.raster_alignment - WARNING - Output rasters still have alignment issues!
2025-07-22 22:40:08,996 - src.processors.data_preparation.raster_alignment - WARNING - Remaining issues: 1
2025-07-22 22:40:08,996 - src.processors.data_preparation.raster_merger - INFO - ‚úÖ Successfully aligned rasters for merging
2025-07-22 22:40:08,996 - src.processors.data_preparation.raster_merger - INFO - Loading plants_richness from /tmp/tmpda7lfwl8/aligned_daru-plants-richness.tif
2025-07-22 22:40:09,010 - src.processors.data_preparation.raster_merger - INFO - Loading terrestrial_richness from /tmp/tmpda7lfwl8/aligned_iucn-terrestrial-richness.tif
2025-07-22 22:40:09,015 - src.processors.data_preparation.raster_merger - WARNING - Aligning terrestrial_richness to reference coordinates
2025-07-22 22:40:09,650 - src.processors.data_preparation.raster_merger - INFO - üßπ Cleaned up temporary alignment files
2025-07-22 22:40:09,650 - __main__ - INFO - ‚úÖ Merged data shape: {'lon': 21600, 'lat': 10410}
2025-07-22 22:40:09,650 - __main__ - INFO -    Bands: ['plants_richness', 'terrestrial_richness']
2025-07-22 22:40:09,650 - __main__ - INFO - ‚úÖ Checkpoint saved: datasets_merged
2025-07-22 22:40:09,651 - __main__ - INFO - üß† STAGE 3: Running SOM analysis...
2025-07-22 22:40:09,651 - __main__ - INFO - üìä SOM Analysis details:
2025-07-22 22:40:09,651 - __main__ - INFO -    Grid: [8, 8] (64 neurons)
2025-07-22 22:40:09,651 - __main__ - INFO -    Samples: 224,856,000
2025-07-22 22:40:09,651 - __main__ - INFO -    Features: 2
2025-07-22 22:40:09,651 - __main__ - INFO -    Iterations: 1000
2025-07-22 22:40:09,651 - __main__ - INFO - ‚è±Ô∏è  Estimated SOM time: ~3m
2025-07-22 22:40:09,651 - __main__ - INFO - SOM parameters: {'grid_size': [8, 8], 'iterations': 1000, 'sigma': 1.5, 'learning_rate': 0.5, 'neighborhood_function': 'gaussian', 'random_seed': 42}
2025-07-22 22:40:09,651 - src.spatial_analysis.som.som_trainer - INFO - Starting SOM analysis
2025-07-22 22:40:22,471 - src.spatial_analysis.base_analyzer - INFO - Progress: 20.0% - Preparing data
2025-07-22 22:40:22,472 - src.spatial_analysis.base_analyzer - INFO - Preparing data for SOMAnalyzer
2025-07-22 22:40:38,993 - src.spatial_analysis.som.som_trainer - INFO - Training SOM on 224856000 samples with 2 features
2025-07-22 22:40:38,993 - src.spatial_analysis.base_analyzer - INFO - Progress: 40.0% - Initializing SOM
2025-07-22 22:40:38,993 - src.spatial_analysis.base_analyzer - INFO - Progress: 60.0% - Training SOM
2025-07-22 22:40:39,006 - src.spatial_analysis.base_analyzer - INFO - Progress: 80.0% - Assigning clusters
2025-07-22 22:57:21,454 - src.spatial_analysis.base_analyzer - INFO - Progress: 100.0% - Calculating statistics
2025-07-22 22:57:23,025 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:23,025 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:23,025 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:24,025 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:24,026 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:24,026 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:25,026 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:25,026 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:25,026 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:26,027 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:26,027 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:26,027 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:27,027 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:27,028 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:27,028 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:28,028 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:57:28,395 - src.base.memory_tracker - INFO - Garbage collection freed -48.30 MB
2025-07-22 22:57:28,395 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:57:28,707 - src.base.memory_tracker - INFO - Garbage collection freed -53.34 MB
2025-07-22 22:57:28,707 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:57:29,017 - src.base.memory_tracker - INFO - Garbage collection freed -69.71 MB
2025-07-22 22:57:30,018 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:57:30,400 - src.base.memory_tracker - INFO - Garbage collection freed 69.27 MB
2025-07-22 22:57:30,400 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:57:30,753 - src.base.memory_tracker - INFO - Garbage collection freed 32.11 MB
2025-07-22 22:57:30,753 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:57:31,103 - src.base.memory_tracker - INFO - Garbage collection freed 53.99 MB
2025-07-22 22:57:32,104 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:32,104 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:32,104 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:33,105 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:33,105 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:33,105 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:34,106 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:34,106 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:34,106 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:35,106 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:35,106 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:35,106 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:36,107 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:36,107 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:36,107 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:57:37,108 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:57:37,470 - src.base.memory_tracker - INFO - Garbage collection freed 40.43 MB
2025-07-22 22:57:37,470 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:57:37,800 - src.base.memory_tracker - INFO - Garbage collection freed 16.14 MB
2025-07-22 22:57:37,801 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:57:38,141 - src.base.memory_tracker - INFO - Garbage collection freed 34.95 MB
2025-07-22 22:57:39,143 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:57:39,450 - src.base.memory_tracker - INFO - Garbage collection freed -187.09 MB
2025-07-22 22:57:39,450 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:57:39,796 - src.base.memory_tracker - INFO - Garbage collection freed 1.50 MB
2025-07-22 22:57:39,796 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:57:40,088 - src.base.memory_tracker - INFO - Garbage collection freed 0.00 MB
2025-07-22 22:57:41,089 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:57:41,384 - src.base.memory_tracker - INFO - Garbage collection freed 0.00 MB
2025-07-22 22:57:41,384 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:57:41,680 - src.base.memory_tracker - INFO - Garbage collection freed 0.00 MB
2025-07-22 22:57:41,680 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:57:42,016 - src.base.memory_tracker - INFO - Garbage collection freed 3430.86 MB
2025-07-22 22:58:32,040 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:58:32,040 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:58:32,040 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:58:33,041 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:58:33,041 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:58:33,041 - src.base.processor - WARNING - Memory pressure detected (high)
2025-07-22 22:58:34,042 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:58:34,390 - src.base.memory_tracker - INFO - Garbage collection freed -139.52 MB
2025-07-22 22:58:34,390 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:58:34,737 - src.base.memory_tracker - INFO - Garbage collection freed 48.45 MB
2025-07-22 22:58:34,737 - src.base.processor - WARNING - Memory pressure detected (critical)
2025-07-22 22:58:35,084 - src.base.memory_tracker - INFO - Garbage collection freed -103.98 MB
